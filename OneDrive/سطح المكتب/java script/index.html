<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo App</title>
    <link rel="stylesheet" href="style.css">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    
  </head>
  <body>
    <div class="container">
      <h1>Todo Input</h1>
      <div class="input-box">
        <form name="todoForm" onsubmit="(event) => addTask(event)"></form>
        <div class="input-container">
          <i class="fa-solid fa-book"></i>
          <input
          type="text"
          name="taskInput"
          placeholder="Enter your task here..."
          
        />
        
        </div>
        <div class="error-message"></div>
        <button class="add-task-button">Add new task</button>
      </form>
      </div>
    </div>

    <div class="container">
      <h1>Todo List</h1>
      <ul class="containerlist">
        <button class="filter-all"><li>All</li></button>
        <button class="filter-done"><li>Done</li></button>
        <button class="filter-todo"><li>Todo</li></button>
      </ul>
    </div>

    <div class="container" style="margin-top: 50px">
      <div class="containerlist task-list">
        <!-- Ø§Ù„Ù…Ù‡Ø§Ù… Ø³ØªØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ø¹Ø¨Ø± JavaScript -->
      </div>
    </div>
    <div class="edit-modal modal">
        <div class="modal-content">
          <h2>Rename Task</h2>
          <input type="text" class="edit-task-input" />
          <div class="modal-buttons">
            <button class="save-task-button save-button">Save</button>
            <button class="cancel-task-button cancel-button">Cancel</button>
          </div>
        </div>
    </div>

    <div class="delete-modal modal">
        <div class="modal-content">
          <h2>Delete Task</h2>
          <p>Are you sure you want to delete this task?</p>
          <div class="modal-buttons">
            <button class="confirm-delete-button save-button">Confirm</button>
            <button class="cancel-delete-button cancel-button">Cancel</button>
          </div>
        </div>
    </div>

    

    <div class="button-container">
      <button class="delete-done-tasks-button delete-button delete-done">Delete Done Tasks</button>
      <button class="delete-all-tasks-button delete-button delete-all">Delete All Tasks</button>
    </div>

    <div class="delete-modal modal">
        <div class="modal-content">
          <h2 class="delete-modal-title">Delete Done Tasks</h2>
          <p class="delete-modal-message">Are you sure you want to delete all completed tasks?</p>
          <div class="modal-buttons">
            <button class="confirm-delete-button save-button">Confirm</button>
            <button class="cancel-delete-button cancel-button">Cancel</button>
          </div>
        </div>
    </div>
</body>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    getDocs,
    enableIndexedDbPersistence
  } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-firestore.js";

  // ðŸ”§ Ø¶Ø¹ÙŠ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù‡Ù†Ø§ (Ø§Ù„ØªÙŠ Ù†Ø³Ø®ØªÙŠÙ‡Ø§ Ù…Ù† Firebase)
  const firebaseConfig = {
   apiKey: "AIzaSyBXq7jILw3hQb7xz4FCbISPodcMHCYHSoM",
  authDomain: "to-do-list-b4aa9.firebaseapp.com",
  projectId: "to-do-list-b4aa9",
  storageBucket: "to-do-list-b4aa9.firebasestorage.app",
  messagingSenderId: "794888143408",
  appId: "1:794888143408:web:d4c9de813cc43b7e8063f5"
  };

  // ðŸš€ ØªÙ‡ÙŠØ¦Ø© Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ðŸŒ™ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø£ÙˆÙÙ„Ø§ÙŠÙ† (Data Persistence)
  enableIndexedDbPersistence(db).catch(err => {
    console.log("Persistence error:", err);
  });

  // âž• Ù…Ø«Ø§Ù„: Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© (Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª)
  async function addTask() {
    const title = document.getElementById("task").value;

    await addDoc(collection(db, "tasks"), {
      title,
      done: false,
      createdAt: Date.now()
    });

    alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ¨ (Ø­ØªÙ‰ Ù„Ùˆ Ø§Ù„Ø§Ù†ØªØ±Ù†Øª Ù…Ù‚Ø·ÙˆØ¹)");
  }

  // ðŸ“¥ Ù…Ø«Ø§Ù„: Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù‡Ø§Ù…
  async function loadTasks() {
    const list = document.getElementById("list");
    list.innerHTML = "";

    const snapshot = await getDocs(collection(db, "tasks"));
    snapshot.forEach(doc => {
      const li = document.createElement("li");
      li.textContent = doc.data().title;
      list.appendChild(li);
    });
  }

  // Ù†Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© Ù„Ù„Ø²Ø±Ø§Ø±
  window.addTask = addTask;
  window.loadTasks = loadTasks;
</script>
  <script>
    
  const todoInput = document.querySelector("input[name='taskInput']"); const errorDiv = document.querySelector(".error-message");
   const addTaskButton = document.querySelector(".add-task-button");
   //const todoInput = document.querySelector(".todo-input"); const errorDiv = document.querySelector(".error-message");
   const taskList = document.querySelector(".task-list");
   const filterAllButton = document.querySelector(".filter-all");
   const filterDoneButton = document.querySelector(".filter-done");
   const filterTodoButton = document.querySelector(".filter-todo");
   const deleteDoneTasksButton = document.querySelector(".delete-done-tasks-button");
   const deleteAllTasksButton = document.querySelector(".delete-all-tasks-button");

   const deleteModal = document.querySelector(".delete-modal");
   const confirmDeleteButton = document.querySelector(".confirm-delete-button");
   const cancelDeleteButton = document.querySelector(".cancel-delete-button");

   const editModal = document.querySelector(".edit-modal");
   const editTaskInput = document.querySelector(".edit-task-input");
   const saveTaskButton = document.querySelector(".save-task-button");
   const cancelTaskButton = document.querySelector(".cancel-task-button");
  
    let currentDeleteType = null; // Ù„ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø­Ø°Ù (ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø£Ùˆ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©)
    let currentDeleteIndex = null;
    let currentEditIndex = null;
  
    const defaultTasks = [
  { text: "Learn ReactJS basics", done: false, isDefault: true },
  { text: "Practice ReactJS", done: false, isDefault: true },
  { text: "Learn Redux", done: false, isDefault: true },
  { text: "Code portfolio in React", done: false, isDefault: true },
  { text: "Learn React Native", done: false, isDefault: true },
];
  
    let tasks = []; // Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  
    // Ø­ÙØ¸ Ø§Ù„Ù…Ù‡Ø§Ù… ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
   
    const loadTasksFromLocalStorage = () => {
  const isFirstLoad = !localStorage.getItem("hasLoadedBefore"); // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ø°Ù‡ Ø£ÙˆÙ„ Ù…Ø±Ø©
  if (isFirstLoad) {
    tasks = [...defaultTasks]; // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    saveTasksToLocalStorage(); // Ø­ÙØ¸ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    localStorage.setItem("hasLoadedBefore", "true"); // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ÙØªØ§Ø­
  } else {
    const savedTasks = localStorage.getItem("tasks"); // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø®Ø²Ù†Ø©
    tasks = savedTasks ? JSON.parse(savedTasks) : [...defaultTasks]; // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ø£Ùˆ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
  }
};
const saveTasksToLocalStorage = () => {
  localStorage.setItem("tasks", JSON.stringify(tasks)); // Ø­ÙØ¸ Ø§Ù„Ù…Ù‡Ø§Ù… ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
};
  

  
    // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù…
    const renderTasks = (filteredTasks = tasks) => {
  taskList.innerHTML = ""; // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ

  if (filteredTasks.length === 0) {
    taskList.innerHTML = "<p>No tasks available</p>";
    updateButtonStates();
    return;
  }

  filteredTasks.forEach((task, index) => {
    const taskElement = document.createElement("div");
    taskElement.classList.add("list-box");
    taskElement.innerHTML = `
      <div>
        <span class="task-text ${task.done ? "task-done" : ""}">
          ${String.fromCharCode(97 + index)}. ${task.text} <!-- a, b, c -->
        </span>
      </div>
      <div>
        <input type="checkbox" class="task-checkbox" ${
          task.done ? "checked" : ""
        } data-index="${index}" />
        <i class="fa-solid fa-pen edit-icon" data-index="${index}"></i>
        <i class="fa-solid fa-trash-can delete-icon" data-index="${index}"></i>
      </div>
    `;
    taskList.appendChild(taskElement);

    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
    addTaskEvents(taskElement, index);
  });

  updateButtonStates();
};
  
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„ÙƒÙ„ Ø¹Ù†ØµØ±
    const addTaskEvents = (taskElement, index) => {
  // ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù‡Ù…Ø©
  taskElement.querySelector(".task-checkbox").addEventListener("change", (e) => {
    tasks[index].done = e.target.checked;
    saveTasksToLocalStorage();
    renderTasks();
  });

  // ÙØªØ­ Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©
  taskElement.querySelector(".fa-pen").addEventListener("click", () => {
    currentEditIndex = index;
    editTaskInput.value = tasks[index].text;
    editModal.style.display = "block";
  });

  // ÙØªØ­ Ù†Ø§ÙØ°Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù
  taskElement.querySelector(".fa-trash-can").addEventListener("click", () => {
    currentDeleteIndex = index; // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ø­Ø°Ù
    currentDeleteType = null; // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø­Ø°Ù Ø§Ù„Ø¹Ø§Ù…
    deleteModal.style.display = "block"; // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯
  });
};
  
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
    todoInput.addEventListener("input", () => {
      const task = todoInput.value.trim();
      if (task === "") {
        showError("Task cannot be empty.");
      } else if (!isNaN(task.charAt(0))) {
        showError("Task cannot start with a number.");
      } else if (task.length < 5) {
        showError("Task must be at least 5 characters long.");
      } else {
        clearError();
      }
    });
   // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
   const updateDatalist = () => {
    const datalist = document.getElementById("customTasks");
  datalist.innerHTML = ""; // Ù…Ø³Ø­ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©

  const uniqueTasks = new Set();

  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
  tasks.forEach((task) => {
    if (!task.isDefault) {
      uniqueTasks.add(task.text);
    }
  });

  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙØ±ÙŠØ¯Ø© Ø¥Ù„Ù‰ datalist
  uniqueTasks.forEach((taskText) => {
    const option = document.createElement("option");
    option.value = taskText;
    datalist.appendChild(option);
  });
};



const updateButtonStates = () => {
  // Ø²Ø± "Delete All Tasks"
  if (tasks.length === 0) {
    deleteAllTasksButton.disabled = true;
    deleteAllTasksButton.style.backgroundColor = "red";
  } else {
    deleteAllTasksButton.disabled = false;
    deleteAllTasksButton.style.backgroundColor = "#007bff";
  }

  // Ø²Ø± "Delete Done Tasks"
  if (tasks.every((task) => !task.done)) {
    deleteDoneTasksButton.disabled = true;
    deleteDoneTasksButton.style.backgroundColor = "red";
  } else {
    deleteDoneTasksButton.disabled = false;
    deleteDoneTasksButton.style.backgroundColor = "#007bff";
  }
};

// Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener("DOMContentLoaded", () => {
  loadTasksFromLocalStorage();
  renderTasks();
  updateDatalist(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
});
let activeFilter = localStorage.getItem("activeFilter") || "all"; // Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©

// Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù…
filterAllButton.addEventListener("click", () => {
  renderTasks();
  setActiveFilter("all");
});

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© ÙÙ‚Ø·
filterDoneButton.addEventListener("click", () => {
  renderTasks(tasks.filter((task) => task.done));
  setActiveFilter("done");
});

// Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù… ØºÙŠØ± Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© ÙÙ‚Ø·
filterTodoButton.addEventListener("click", () => {
  renderTasks(tasks.filter((task) => !task.done));
  setActiveFilter("todo");
});

// Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù„Ù„ÙÙ„ØªØ±
const setActiveFilter = (filter) => {
  activeFilter = filter;
  localStorage.setItem("activeFilter", filter);
};

// ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ù†Ø´Ø· Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener("DOMContentLoaded", () => {
  loadTasksFromLocalStorage();

  // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ù†Ø´Ø·
  if (activeFilter === "done") {
    renderTasks(tasks.filter((task) => task.done));
  } else if (activeFilter === "todo") {
    renderTasks(tasks.filter((task) => !task.done));
  } else {
    renderTasks();
  }

  updateDatalist(); 
});


// Ø¹Ù†Ø¯ Ø­Ø°Ù Ù…Ù‡Ù…Ø©
confirmDeleteButton.addEventListener("click", () => {
  let deletedTaskText = null;
  if (currentDeleteIndex !== null) {
    // Ø­Ø°Ù Ù…Ù‡Ù…Ø© Ù…Ø¹ÙŠÙ†Ø©
    deletedTaskText = tasks[currentDeleteIndex].text;
    tasks.splice(currentDeleteIndex, 1);
    currentDeleteIndex = null; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¤Ø´Ø±
  } else if (currentDeleteType === "done") {
    // Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©
    tasks = tasks.filter((task) => {
      if (task.done) {
        deletedTaskText = task.text;
      }
      return !task.done;
    });
  } else if (currentDeleteType === "all") {
    // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù…
    tasks.forEach((task) => {
      deletedTaskText = task.text;
    });
    tasks = [];
  }


 

  saveTasksToLocalStorage();
  renderTasks();
  updateDatalist(); 
  deleteModal.style.display = "none"; 
  currentDeleteType = null; 
});


    addTaskButton.addEventListener("click", () => {
  const task = todoInput.value.trim();
  if (task === "" || !isNaN(task.charAt(0)) || task.length < 5) {
    showError("Invalid task. Please check your input.");
    return;
  }

  tasks.unshift({ text: task, done: false });
  todoInput.value = "";
  clearError();
  saveTasksToLocalStorage();
  renderTasks();
  updateDatalist(); 
});
  
   
    filterAllButton.addEventListener("click", () => renderTasks());
  
    
    filterDoneButton.addEventListener("click", () =>
      renderTasks(tasks.filter((task) => task.done))
    );
  
    
    filterTodoButton.addEventListener("click", () =>
      renderTasks(tasks.filter((task) => !task.done))
    );
  
    // Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©
    deleteDoneTasksButton.addEventListener("click", () => {
      currentDeleteType = "done";
      deleteModal.style.display = "block";
    });
  
   
    deleteAllTasksButton.addEventListener("click", () => {
      currentDeleteType = "all";
      deleteModal.style.display = "block";
    });
  
    
    saveTaskButton.addEventListener("click", () => {
      if (currentEditIndex !== null) {
        tasks[currentEditIndex].text = editTaskInput.value.trim();
        saveTasksToLocalStorage();
        renderTasks();
        editModal.style.display = "none";
      }
    });
  
    
    cancelTaskButton.addEventListener("click", () => {
      editModal.style.display = "none";
      currentEditIndex = null;
    });
  
   
    confirmDeleteButton.addEventListener("click", () => {
  if (currentDeleteIndex !== null) {
    
    tasks.splice(currentDeleteIndex, 1);
    currentDeleteIndex = null; 
  } else if (currentDeleteType === "done") {
    
    tasks = tasks.filter((task) => !task.done);
  } else if (currentDeleteType === "all") {
  
    tasks = [];
  }

  saveTasksToLocalStorage(); 
  renderTasks(); 
  updateButtonStates();
  deleteModal.style.display = "none";
  currentDeleteType = null; 
});
  
   
    cancelDeleteButton.addEventListener("click", () => {
      deleteModal.style.display = "none";
      currentDeleteType = null;
    });
  
   
    const showError = (message) => {
   errorDiv.textContent = message;
   };


  const clearError = () => {
  errorDiv.textContent = "";
   };
  

  </script>
  
 Â </body>